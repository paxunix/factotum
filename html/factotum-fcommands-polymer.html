<!DOCTYPE html>

<head>
  <link rel="import" href="../bower_components/polymer/polymer.html">
  <link rel="import" href="../bower_components/iron-icons/iron-icons.html">
  <link rel="import" href="../bower_components/paper-item/paper-icon-item.html">
  <link rel="import" href="../bower_components/paper-input/paper-textarea.html">
  <link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
  <link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
  <link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
  <link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
  <link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
  <link rel="import" href="factotum-shared-styles.html">
</head>

<dom-module id="factotum-fcommands">

<template>
  <style include="factotum-shared-styles">
    paper-icon-item {
      cursor: pointer;
    }

    /* Push the drawer content down so app-header toolbar doesn't cover it */
    #drawer-content {
      margin-top: 80px;
      height: calc(100% - 80px);
      overflow: auto;
    }

    #editPane {
      --paper-input-container-input-color: var(--secondary-text-color);
      --paper-input-container-input: {
          @apply --paper-font-common-code;
          font-size: 10pt;
          line-height: default;
      };
    }
  </style>

  <app-header-layout fullbleed>
    <app-header slot="header" fixed>
      <app-toolbar>
        <div main-title>Factotum Fcommands</div>
      </app-toolbar>
    </app-header>

    <div>
    <app-drawer-layout>
      <app-drawer slot="drawer">
        <div id="drawer-content">
          <template is="dom-repeat" items="[[fcommandList]]">
            <paper-icon-item>
              <iron-icon icon="settings" slot="item-icon"></iron-icon>
              [[item.extractedData.title]]
            </paper-icon-item>
          </template>
        </div>
      </app-drawer>

      <paper-textarea id="editPane" label="Fcommand Markup" placeholder="Enter Fcommand markup here" rows="40" on-keydown="_onTabKey"></paper-textarea>

    </app-drawer-layout>
    <div>
  </app-header-layout>
</template>

<script>
"use strict";

class FcommandsElement extends Polymer.Element
{
    static get is()
    {
        return "factotum-fcommands";
    }


    static get properties()
    {
        return {
            fcommandList: {
                type: Array,
                value: [],
            },
        };
    }


    _onTabKey(evt)
    {
        if (evt.key === "Tab")
            console.log("TAB pressed", evt);
    }


    ready()
    {
        super.ready();

        chrome.runtime.getBackgroundPage(bgScope => {
            bgScope.g_fcommandManager.getAll().then((fcommands) => {
                for (let fcommand of fcommands)
                {
                    this.push("fcommandList", fcommand);
                }
            });
        });
    }
}

customElements.define(FcommandsElement.is, FcommandsElement);
</script>

</dom-module>
